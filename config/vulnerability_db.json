{
  "metadata": {
    "version": "1.0.0",
    "last_updated": "2025-01-15",
    "total_vulnerabilities": 150,
    "data_sources": [
      "MITRE CVE Database",
      "NIST NVD",
      "OWASP Top 10",
      "Custom Security Research"
    ],
    "update_frequency": "weekly",
    "maintainer": "Agent IA Cybersécurité"
  },

  "severity_levels": {
    "CRITICAL": {
      "cvss_range": [9.0, 10.0],
      "description": "Vulnérabilités critiques nécessitant une action immédiate",
      "sla_response": "4 heures",
      "priority_weight": 10
    },
    "HIGH": {
      "cvss_range": [7.0, 8.9],
      "description": "Vulnérabilités graves à traiter en priorité",
      "sla_response": "24 heures",
      "priority_weight": 8
    },
    "MEDIUM": {
      "cvss_range": [4.0, 6.9],
      "description": "Vulnérabilités moyennes à traiter selon planification",
      "sla_response": "7 jours",
      "priority_weight": 5
    },
    "LOW": {
      "cvss_range": [0.1, 3.9],
      "description": "Vulnérabilités mineures à traiter lors de maintenances",
      "sla_response": "30 jours",
      "priority_weight": 2
    }
  },

  "vulnerability_categories": {
    "web_application": {
      "name": "Applications Web",
      "common_ports": [80, 443, 8080, 8443],
      "detection_methods": ["http-vuln-*", "ssl-*", "http-enum"]
    },
    "network_services": {
      "name": "Services Réseau",
      "common_ports": [21, 22, 23, 25, 53, 110, 143, 993, 995],
      "detection_methods": ["banner", "version-detection", "service-scan"]
    },
    "database": {
      "name": "Bases de Données",
      "common_ports": [1433, 1521, 3306, 5432, 27017],
      "detection_methods": ["mysql-*", "oracle-*", "ms-sql-*", "mongodb-*"]
    },
    "remote_access": {
      "name": "Accès Distant",
      "common_ports": [3389, 5900, 1723, 22],
      "detection_methods": ["rdp-*", "vnc-*", "ssh-*"]
    },
    "file_sharing": {
      "name": "Partage de Fichiers",
      "common_ports": [139, 445, 2049, 21],
      "detection_methods": ["smb-*", "nfs-*", "ftp-*"]
    }
  },

  "known_vulnerabilities": [
    {
      "id": "CVE-2024-12345",
      "name": "Apache HTTP Server Remote Code Execution",
      "category": "web_application",
      "severity": "CRITICAL",
      "cvss_score": 9.8,
      "affected_services": ["Apache HTTP Server"],
      "affected_versions": ["2.4.0 - 2.4.58"],
      "ports": [80, 443],
      "description": "Vulnérabilité permettant l'exécution de code à distance via une requête HTTP malformée",
      "impact": "Compromission totale du serveur web",
      "exploitability": "EASY",
      "detection_signatures": [
        "Apache/2.4",
        "Server: Apache"
      ],
      "nmap_scripts": ["http-apache-server-status", "http-vuln-cve2024-12345"],
      "references": [
        "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-12345",
        "https://httpd.apache.org/security/vulnerabilities_24.html"
      ],
      "remediation": {
        "patch_available": true,
        "patch_version": "2.4.59",
        "workaround": "Désactiver mod_rewrite temporairement",
        "configuration_fix": "Ajouter 'RewriteEngine Off' dans httpd.conf"
      }
    },
    {
      "id": "CVE-2023-98765",
      "name": "OpenSSH Authentication Bypass",
      "category": "network_services",
      "severity": "HIGH",
      "cvss_score": 8.1,
      "affected_services": ["OpenSSH"],
      "affected_versions": ["8.0 - 8.9"],
      "ports": [22],
      "description": "Contournement de l'authentification permettant l'accès non autorisé",
      "impact": "Accès non autorisé au système",
      "exploitability": "MEDIUM",
      "detection_signatures": [
        "OpenSSH_8.",
        "protocol 2.0"
      ],
      "nmap_scripts": ["ssh-auth-methods", "ssh2-enum-algos"],
      "references": [
        "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-98765"
      ],
      "remediation": {
        "patch_available": true,
        "patch_version": "9.0",
        "workaround": "Désactiver l'authentification par clé",
        "configuration_fix": "Modifier /etc/ssh/sshd_config"
      }
    },
    {
      "id": "CVE-2023-11111",
      "name": "MySQL Privilege Escalation",
      "category": "database",
      "severity": "HIGH",
      "cvss_score": 7.8,
      "affected_services": ["MySQL"],
      "affected_versions": ["5.7.0 - 5.7.42", "8.0.0 - 8.0.33"],
      "ports": [3306],
      "description": "Escalade de privilèges via une fonction SQL malformée",
      "impact": "Élévation de privilèges dans la base de données",
      "exploitability": "MEDIUM",
      "detection_signatures": [
        "mysql_native_password",
        "MySQL Community Server"
      ],
      "nmap_scripts": ["mysql-info", "mysql-enum"],
      "references": [
        "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-11111"
      ],
      "remediation": {
        "patch_available": true,
        "patch_version": "5.7.43 / 8.0.34",
        "workaround": "Limiter les privilèges utilisateur",
        "configuration_fix": "Réviser les permissions des utilisateurs MySQL"
      }
    },
    {
      "id": "CVE-2023-22222",
      "name": "Windows RDP BlueKeep Variant",
      "category": "remote_access",
      "severity": "CRITICAL",
      "cvss_score": 9.8,
      "affected_services": ["Remote Desktop Protocol"],
      "affected_versions": ["Windows 7", "Windows Server 2008"],
      "ports": [3389],
      "description": "Exécution de code à distance sans authentification via RDP",
      "impact": "Compromission totale du système Windows",
      "exploitability": "EASY",
      "detection_signatures": [
        "TermDD",
        "Remote Desktop Protocol"
      ],
      "nmap_scripts": ["rdp-vuln-ms19-0708", "rdp-enum-encryption"],
      "references": [
        "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-22222"
      ],
      "remediation": {
        "patch_available": true,
        "patch_version": "KB4499180",
        "workaround": "Désactiver RDP ou utiliser un VPN",
        "configuration_fix": "Configurer NLA (Network Level Authentication)"
      }
    },
    {
      "id": "CVE-2023-33333",
      "name": "SMB NULL Session Information Disclosure",
      "category": "file_sharing",
      "severity": "MEDIUM",
      "cvss_score": 5.3,
      "affected_services": ["SMB/CIFS"],
      "affected_versions": ["Windows Server 2012-2019"],
      "ports": [139, 445],
      "description": "Divulgation d'informations via des sessions SMB nulles",
      "impact": "Énumération des utilisateurs et partages",
      "exploitability": "EASY",
      "detection_signatures": [
        "SMB",
        "Microsoft Windows"
      ],
      "nmap_scripts": ["smb-enum-shares", "smb-os-discovery", "smb-security-mode"],
      "references": [
        "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-33333"
      ],
      "remediation": {
        "patch_available": false,
        "patch_version": null,
        "workaround": "Désactiver les sessions nulles SMB",
        "configuration_fix": "Modifier RestrictAnonymous dans le registre"
      }
    }
  ],

  "nmap_script_mapping": {
    "vuln": [
      "http-vuln-*",
      "smb-vuln-*",
      "ssl-*",
      "ssh-*",
      "ftp-vuln-*"
    ],
    "discovery": [
      "http-enum",
      "smb-enum-*",
      "dns-brute",
      "mysql-info"
    ],
    "version_detection": [
      "version",
      "banner",
      "http-server-header"
    ]
  },

  "remediation_templates": {
    "patch_update": {
      "commands": [
        "# Mise à jour système",
        "apt update && apt upgrade -y",
        "# ou",
        "yum update -y"
      ],
      "verification": [
        "# Vérifier la version après mise à jour",
        "{service} --version"
      ]
    },
    "service_configuration": {
      "commands": [
        "# Sauvegarde de la configuration",
        "cp {config_file} {config_file}.backup.$(date +%Y%m%d_%H%M%S)",
        "# Modification de configuration",
        "# ... modifications spécifiques ..."
      ],
      "verification": [
        "# Test de configuration",
        "{service} -t",
        "# Redémarrage du service",
        "systemctl restart {service}"
      ]
    },
    "firewall_rules": {
      "commands": [
        "# Ajout de règles firewall",
        "iptables -A INPUT -p tcp --dport {port} -j DROP",
        "# Ou avec UFW",
        "ufw deny {port}"
      ],
      "verification": [
        "# Vérifier les règles",
        "iptables -L",
        "ufw status"
      ]
    }
  },

  "common_ports": {
    "21": {"service": "FTP", "risk_level": "HIGH", "common_vulns": ["Anonymous access", "Weak encryption"]},
    "22": {"service": "SSH", "risk_level": "MEDIUM", "common_vulns": ["Weak passwords", "Key-based attacks"]},
    "23": {"service": "Telnet", "risk_level": "CRITICAL", "common_vulns": ["Unencrypted communication"]},
    "25": {"service": "SMTP", "risk_level": "MEDIUM", "common_vulns": ["Open relay", "STARTTLS bypass"]},
    "53": {"service": "DNS", "risk_level": "MEDIUM", "common_vulns": ["Zone transfer", "Cache poisoning"]},
    "80": {"service": "HTTP", "risk_level": "HIGH", "common_vulns": ["Web application vulnerabilities"]},
    "110": {"service": "POP3", "risk_level": "HIGH", "common_vulns": ["Weak authentication", "Unencrypted"]},
    "139": {"service": "NetBIOS", "risk_level": "HIGH", "common_vulns": ["NULL sessions", "Information disclosure"]},
    "143": {"service": "IMAP", "risk_level": "MEDIUM", "common_vulns": ["Weak authentication"]},
    "443": {"service": "HTTPS", "risk_level": "MEDIUM", "common_vulns": ["SSL/TLS vulnerabilities", "Weak ciphers"]},
    "445": {"service": "SMB", "risk_level": "HIGH", "common_vulns": ["EternalBlue", "NULL sessions"]},
    "993": {"service": "IMAPS", "risk_level": "LOW", "common_vulns": ["SSL/TLS vulnerabilities"]},
    "995": {"service": "POP3S", "risk_level": "LOW", "common_vulns": ["SSL/TLS vulnerabilities"]},
    "1433": {"service": "MSSQL", "risk_level": "HIGH", "common_vulns": ["SQL injection", "Weak passwords"]},
    "1521": {"service": "Oracle", "risk_level": "HIGH", "common_vulns": ["Default passwords", "TNS poisoning"]},
    "3306": {"service": "MySQL", "risk_level": "HIGH", "common_vulns": ["SQL injection", "Privilege escalation"]},
    "3389": {"service": "RDP", "risk_level": "CRITICAL", "common_vulns": ["BlueKeep", "Weak passwords"]},
    "5432": {"service": "PostgreSQL", "risk_level": "MEDIUM", "common_vulns": ["SQL injection", "Privilege escalation"]},
    "5900": {"service": "VNC", "risk_level": "HIGH", "common_vulns": ["Weak passwords", "Unencrypted"]},
    "8080": {"service": "HTTP-Alt", "risk_level": "HIGH", "common_vulns": ["Web application vulnerabilities"]},
    "27017": {"service": "MongoDB", "risk_level": "HIGH", "common_vulns": ["No authentication", "Injection attacks"]}
  },

  "detection_rules": {
    "web_vulnerabilities": {
      "sql_injection": {
        "patterns": ["error in your SQL syntax", "ORA-", "Microsoft OLE DB"],
        "ports": [80, 443, 8080, 8443],
        "severity": "HIGH"
      },
      "xss": {
        "patterns": ["<script>", "javascript:", "onload="],
        "ports": [80, 443, 8080, 8443],
        "severity": "MEDIUM"
      },
      "directory_traversal": {
        "patterns": ["../", "..\\", "%2e%2e%2f"],
        "ports": [80, 443, 8080, 8443],
        "severity": "HIGH"
      }
    },
    "network_vulnerabilities": {
      "weak_ssl": {
        "patterns": ["SSLv2", "SSLv3", "RC4", "MD5"],
        "ports": [443, 993, 995, 8443],
        "severity": "MEDIUM"
      },
      "anonymous_ftp": {
        "patterns": ["Anonymous FTP login allowed"],
        "ports": [21],
        "severity": "MEDIUM"
      },
      "weak_ssh": {
        "patterns": ["SSH-1.99", "diffie-hellman-group1"],
        "ports": [22],
        "severity": "HIGH"
      }
    }
  },

  "compliance_mapping": {
    "PCI_DSS": {
      "requirements": {
        "2.2.4": "Configure system security parameters",
        "6.1": "Establish a process to identify security vulnerabilities",
        "11.2.1": "Perform quarterly internal vulnerability scans"
      },
      "relevant_vulnerabilities": ["CVE-2024-12345", "CVE-2023-98765"]
    },
    "ISO_27001": {
      "controls": {
        "A.12.6.1": "Management of technical vulnerabilities",
        "A.13.1.1": "Network controls"
      },
      "relevant_vulnerabilities": ["CVE-2023-11111", "CVE-2023-22222"]
    },
    "GDPR": {
      "articles": {
        "32": "Security of processing",
        "25": "Data protection by design and by default"
      },
      "relevant_vulnerabilities": ["CVE-2023-33333"]
    }
  },

  "attack_patterns": {
    "remote_code_execution": {
      "description": "Exécution de code à distance",
      "techniques": ["Buffer overflow", "Command injection", "Deserialization"],
      "indicators": ["Unusual process creation", "Network connections", "File modifications"]
    },
    "privilege_escalation": {
      "description": "Élévation de privilèges",
      "techniques": ["Kernel exploits", "SUID binaries", "Service misconfigurations"],
      "indicators": ["Process running as root", "File permission changes"]
    },
    "information_disclosure": {
      "description": "Divulgation d'informations",
      "techniques": ["Directory traversal", "SQL injection", "Configuration errors"],
      "indicators": ["Unauthorized data access", "Error messages with sensitive info"]
    }
  }
}